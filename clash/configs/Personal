---
# ==============================================================================
#
# V2rayN/NG:  https://d.cloudso.club/link/C4OZwUTBHQCvvu2Y?sub=3&extend=1
# Clash:  https://d.cloudso.club/link/C4OZwUTBHQCvvu2Y?clash=1
#
# ------------------------------------------------------------------------------
# 🇲🇴 🇨🇳

mixed-port: 51300
socks-port: 51301
redir-port: 51366
port: 51302

# clash 的 RESTful APIc
external-controller: "127.0.0.1:51399"

# 规则模式：Rule（规则） / Global（全局代理）/ Direct（全局直连）
mode: rule

# 设置日志输出级别 (默认级别：silent，即不输出任何内容，以避免因日志内容过大而导致程序内存溢出）。
# 5 个级别: silent / info / warning / error / debug。级别越高日志输出量越大，越倾向于调试，若需要请自行开启。
log-level: error

# RESTful API secret
secret: "p0o9i8u7"

# 允许局域网的连接（可用来共享代理）
allow-lan: false
# 此功能仅在 allow-lan 设置为 true 时生效，支持三种参数：
# "*"                           绑定所有的 IP 地址
# 192.168.122.11                绑定一个 IPv4 地址
# "[aaaa::a8aa:ff:fe09:57d8]"   绑定一个 IPv6 地址
# bind-address: "*"
# bind-address: "172.28.12.169"

# 本地 SOCKS5 / HTTP(S) 服务认证
# authentication:
#   - "myUsername:myPassword"

# ------------------------------------------------------------------------------
# 您可以将静态网页资源（如 clash-dashboard）放置在一个目录中，clash 将会服务于 `${API}/ui`
# 参数应填写配置目录的相对路径或绝对路径。
# external-ui: folder

# # 实验性功能 hosts, 支持通配符 (例如 *.clash.dev 甚至 *.foo.*.example.com)
# # 静态的域名 比 通配域名 具有更高的优先级 (foo.example.com 优先于 *.example.com)
# # 注意: hosts 在 fake-ip 模式下不生效
hosts:
  "*.chenzhenyuan.cn": 127.0.0.1
  "chenzhenyuan.cn": 127.0.0.1
  "*.chenzhenyuan.io": 127.0.0.1
  "chenzhenyuan.io": 127.0.0.1

dns:
  # 是否启用dns
  enable: true
  ipv6: true
  use-hosts: true
  listen: 127.0.0.1:53
  # 模式: redir-host或fake-ip
  enhanced-mode: redir-host
  fake-ip-range: 198.18.0.1/16
  # #列表中的域名将不会被解析为fake ip，这些域名相关的解析请求将会返回它们真实的IP地址
  fake-ip-filter:
    - "*.lan"
    - "*.local"
    - "chenzhenyuan.com"
    - "*.chenzhenyuan.com"
    - "*.battlenet.com.cn"
    - "*.battlenet.com"
    - "*.blzstatic.cn"
    - "*.battle.net"
    - "+.srv.nintendo.net"
    - "+.stun.playstation.net"
    - "+.msftconnecttest.com"
    - "+.msftncsi.com"
    - "+.xboxlive.com"
    - "*.ip.sb"
    - "ip.sb"
    - "localhost.ptlogin2.qq.com"
    - "msftconnecttest.com"
    - "xbox.*.microsoft.com"
    - "jsdelivr.net"
    - "raw.gitmirror.com"
    - "*.jsdelivr.net"

  default-nameserver:
    # DNSPod
    - 119.29.29.29
    - 119.28.28.28
    # 阿里云DNS
    - 223.5.5.5
    # 114DNS
    - 114.114.114.114

  nameserver:
    - https://doh.pub/dns-query
    # 阿里云 DoH DNS
    - https://dns.alidns.com/dns-query
    # DNSPod
    - 119.29.29.29
    # 阿里云DNS
    - 223.5.5.5
    # ONE DNS拦截版 恶意网站拦截、广告过滤
    - 117.50.11.11
    # ONE DNS纯净版 直接返回其真实的响应结果
    - 117.50.10.10
    # 114DNS
    - 114.114.114.114

  nameserver-policy:
    # 私人域名
    "chenzhenyuan.com": 119.29.29.29
    "*.chenzhenyuan.com": 119.29.29.29
    "jsdelivr.net": 119.29.29.29
    "*.jsdelivr.net": 119.29.29.29

  fallback:
    - https://doh.dns.sb/dns-query
    # Google
    - tls://8.8.4.4:853
    - tls://dns.google:853
    - https://dns.google/dns-query
    # Cloudflare DNS
    - tls://1.0.0.1:853
    - https://dns.cloudflare.com/dns-query
    - https://cloudflare-dns.com/dns-query
    # - 1.1.1.1
    - tls://dns.rubyfish.cn:853
    # - https://dns.rubyfish.cn/dns-query

  fallback-filter:
    # 默认
    geoip: true
    # domain:
    # 在这个网段内的 IP 地址会被考虑为被污染的 IP
    ipcidr:
      # - 0.0.0.0/32
      - 240.0.0.0/4

proxy-providers:
  香港机房:
    type: http
    path: ./proxies/HongKong.yaml
    url: https://chenzhenyuan.com/clash/proxies/HongKong.yaml
    filter: 香港
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300

  台湾机房:
    type: http
    path: ./proxies/Taiwan.yaml
    url: https://chenzhenyuan.com/clash/proxies/Taiwan.yaml
    filter: 台湾
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300

  新加坡机房:
    type: http
    path: ./proxies/Singapore.yaml
    url: https://chenzhenyuan.com/clash/proxies/Singapore.yaml
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300

  日本机房:
    type: http
    path: ./proxies/Japan.yaml
    url: https://chenzhenyuan.com/clash/proxies/Japan.yaml
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300

  韩国机房:
    type: http
    path: ./proxies/Korea.yaml
    url: https://chenzhenyuan.com/clash/proxies/Korea.yaml
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300

  美国机房:
    type: http
    path: ./proxies/America.yaml
    url: https://chenzhenyuan.com/clash/proxies/America.yaml
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300

  其他机房:
    type: http
    path: ./proxies/GlobalArea.yaml
    url: https://chenzhenyuan.com/clash/proxies/GlobalArea.yaml
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300

rule-providers:
  # 苹果服务
  Apple:
    type: http
    behavior: domain
    url: https://chenzhenyuan.com/clash/rules/apple.yaml
    path: ./ruleset/chenzhenyuan/apple.yaml
    interval: 3600
  # 常用进程名
  Applications:
    type: http
    behavior: classical
    url: https://chenzhenyuan.com/clash/rules/applications.yaml
    path: ./ruleset/chenzhenyuan/applications.yaml
    interval: 3600
  # 广告商
  BanAD:
    type: http
    behavior: classical
    url: https://cdn.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Providers/BanAD.yaml
    path: ./ruleset/ACL4SSR/ACL4SSR/BanAD.yaml
    interval: 3600
  BanEasyList:
    type: http
    behavior: classical
    url: https://cdn.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Providers/BanEasyList.yaml
    path: ./ruleset/ACL4SSR/ACL4SSR/BanEasyList.yaml
    interval: 3600
  ChinaDomain:
    type: http
    behavior: classical
    url: https://cdn.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Providers/ChinaDomain.yaml
    path: ./ruleset/ACL4SSR/ACL4SSR/ChinaDomain.yaml
    interval: 3600
  # GitHub
  GitHub:
    type: http
    behavior: classical
    url: https://chenzhenyuan.com/clash/rules/github.yaml
    path: ./ruleset/chenzhenyuan/github.yaml
    interval: 3600
  Google:
    type: http
    behavior: domain
    url: https://chenzhenyuan.com/clash/rules/google.yaml
    path: ./ruleset/chenzhenyuan/google.yaml
    interval: 3600
  # 局域网
  LocalAreaNetwork:
    type: http
    behavior: classical
    url: https://chenzhenyuan.com/clash/rules/lan.yaml
    path: ./ruleset/chenzhenyuan/lan.yaml
    interval: 86400
  # # GFWlist
  GFW:
    type: http
    behavior: domain
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/gfw.txt
    path: ./ruleset/Loyalsoldier/clash-rules/ProxyGFWlist.yaml
    interval: 3600
  # Telegram
  Telegram:
    type: http
    behavior: domain
    url: https://chenzhenyuan.com/clash/rules/telegram.yaml
    path: ./ruleset/chenzhenyuan/telegram.yaml
    interval: 3600
  # Twitter
  Twitter:
    type: http
    behavior: classical
    url: https://chenzhenyuan.com/clash/rules/twitter.yaml
    path: ./ruleset/chenzhenyuan/twitter.yaml
    interval: 3600

proxy-groups:
  - name: 默认线路
    # <url-test | select | load-balance | random | fallback>
    type: select
    proxies:
      - 全球负载
      - 集群线路
      - 香港负载
      - 台湾负载
      - 新加坡负载
      - 美国负载
      - 日本负载
      - 韩国负载
      - 其他负载

  - name: 全球负载
    type: load-balance
    url: "http://www.gstatic.com/generate_204"
    interval: 180
    lazy: false
    proxies:
      - 香港负载
      - 台湾负载
      - 新加坡负载
      - 美国负载
      - 日本负载
      - 韩国负载
      - 其他负载
  - name: 集群线路
    type: select
    proxies:
      - 香港集群
      - 台湾集群
      - 新加坡集群
      - 日本集群
      - 韩国集群
      - 美国集群
      - 其他集群

  # ============================================================================
  - name: 香港集群
    type: url-test
    url: "http://www.gstatic.com/generate_204"
    interval: 300
    lazy: false
    use:
      - 香港机房
  - name: 台湾集群
    type: url-test
    url: "http://www.gstatic.com/generate_204"
    interval: 300
    lazy: false
    use:
      - 台湾机房
  - name: 新加坡集群
    type: url-test
    url: "http://www.gstatic.com/generate_204"
    interval: 300
    lazy: false
    use:
      - 新加坡机房
  - name: 日本集群
    type: url-test
    url: "http://www.gstatic.com/generate_204"
    interval: 300
    lazy: false
    use:
      - 日本机房
  - name: 韩国集群
    type: url-test
    url: "http://www.gstatic.com/generate_204"
    interval: 300
    lazy: false
    use:
      - 韩国机房
  - name: 美国集群
    type: url-test
    url: "http://www.gstatic.com/generate_204"
    interval: 300
    lazy: false
    use:
      - 美国机房
  - name: 其他集群
    type: url-test
    url: "http://www.gstatic.com/generate_204"
    interval: 300
    lazy: false
    use:
      - 其他机房

  # ============================================================================
  - name: 香港负载
    type: load-balance
    url: "http://www.gstatic.com/generate_204"
    interval: 300
    lazy: false
    use:
      - 香港机房
  - name: 台湾负载
    type: load-balance
    url: "http://www.gstatic.com/generate_204"
    interval: 10
    lazy: false
    use:
      - 台湾机房
  - name: 新加坡负载
    type: load-balance
    url: "http://www.gstatic.com/generate_204"
    interval: 300
    lazy: false
    use:
      - 新加坡机房
  - name: 美国负载
    type: load-balance
    url: "http://www.gstatic.com/generate_204"
    interval: 300
    lazy: false
    use:
      - 美国机房
  - name: 日本负载
    type: load-balance
    url: "http://www.gstatic.com/generate_204"
    interval: 300
    lazy: false
    use:
      - 日本机房
  - name: 韩国负载
    type: load-balance
    url: "http://www.gstatic.com/generate_204"
    interval: 300
    lazy: false
    use:
      - 韩国机房
  - name: 其他负载
    type: load-balance
    url: "http://www.gstatic.com/generate_204"
    interval: 300
    lazy: false
    use:
      - 其他机房

rules:
  # ============================================================================
  # 私人域名 相关的规则
  # ----------------------------------------------------------------------------
  - DOMAIN-SUFFIX,chenzhenyuan.com,DIRECT
  - DOMAIN-SUFFIX,mac-torrent-download.net,默认线路
  - DOMAIN,raw.gitmirror.com,DIRECT,no-resolve
  - DOMAIN,raw.iqiq.io,DIRECT,no-resolve
  - DOMAIN-SUFFIX,sketch.cloud,DIRECT

  # ============================================================================
  # IP测试 相关的规则
  # ----------------------------------------------------------------------------
  - DOMAIN,ip.900cha.com,DIRECT,no-resolve
  - DOMAIN-SUFFIX,ip.sb,DIRECT,no-resolve
  - DOMAIN-SUFFIX,local,DIRECT,no-resolve
  - DOMAIN,jayne-mini.local,DIRECT,no-resolve

  # ============================================================================
  # 常见广告域名屏蔽
  # ----------------------------------------------------------------------------
  - DOMAIN,injections.adguard.org,REJECT
  - DOMAIN,local.adguard.org,REJECT
  - DOMAIN-SUFFIX,appsflyer.com,REJECT
  - DOMAIN-SUFFIX,doubleclick.net,REJECT
  - DOMAIN-SUFFIX,mmstat.com,REJECT
  - DOMAIN-SUFFIX,vungle.com,REJECT
  - DOMAIN-KEYWORD,admarvel,REJECT
  - DOMAIN-KEYWORD,admaster,REJECT
  - DOMAIN-KEYWORD,adsage,REJECT
  - DOMAIN-KEYWORD,adsmogo,REJECT
  - DOMAIN-KEYWORD,adsrvmedia,REJECT
  - DOMAIN-KEYWORD,adwords,REJECT
  - DOMAIN-KEYWORD,adservice,REJECT
  - DOMAIN-KEYWORD,domob,REJECT
  - DOMAIN-KEYWORD,duomeng,REJECT
  - DOMAIN-KEYWORD,dwtrack,REJECT
  - DOMAIN-KEYWORD,guanggao,REJECT
  - DOMAIN-KEYWORD,lianmeng,REJECT
  - DOMAIN-KEYWORD,mopub,REJECT
  - DOMAIN-KEYWORD,omgmta,REJECT
  - DOMAIN-KEYWORD,openx,REJECT
  - DOMAIN-KEYWORD,partnerad,REJECT
  - DOMAIN-KEYWORD,pingfore,REJECT
  - DOMAIN-KEYWORD,supersonicads,REJECT
  - DOMAIN-KEYWORD,uedas,REJECT
  - DOMAIN-KEYWORD,umeng,REJECT
  - DOMAIN-KEYWORD,usage,REJECT
  - DOMAIN-KEYWORD,wlmonitor,REJECT
  - DOMAIN-KEYWORD,zjtoolbar,REJECT
  - RULE-SET,BanAD,REJECT
  - RULE-SET,BanEasyList,REJECT

  # ============================================================================
  # 规则集
  # ----------------------------------------------------------------------------
  - RULE-SET,LocalAreaNetwork,DIRECT
  - RULE-SET,Apple,DIRECT
  - RULE-SET,ChinaDomain,DIRECT
  - RULE-SET,GitHub,香港集群
  - RULE-SET,Telegram,台湾负载
  - RULE-SET,Twitter,台湾负载
  # - RULE-SET,ProxyGFWlist,默认线路

  # 进程名
  - PROCESS-NAME,BitTorrent Web,DIRECT
  - PROCESS-NAME,qbittorrent,DIRECT
  - PROCESS-NAME,aCity,默认线路
  - PROCESS-NAME,Twitter,台湾负载

  # ============================================================================
  # IP 规则
  # ----------------------------------------------------------------------------
  - DOMAIN-SUFFIX,cn,DIRECT
  - DOMAIN-KEYWORD,-cn,DIRECT
  - IP-CIDR6,2001:67c:4e8::/48,默认线路,no-resolve
  - IP-CIDR6,2001:b28:f23d::/48,默认线路,no-resolve
  - IP-CIDR6,2001:b28:f23f::/48,默认线路,no-resolve
  - IP-CIDR,91.108.4.0/22,默认线路,no-resolve
  - IP-CIDR,91.108.8.0/21,默认线路,no-resolve
  - IP-CIDR,91.108.16.0/22,默认线路,no-resolve
  - IP-CIDR,91.108.56.0/22,默认线路,no-resolve
  - IP-CIDR,149.154.160.0/20,默认线路,no-resolve
  - IP-CIDR,120.232.181.162/32,默认线路,no-resolve
  - IP-CIDR,120.241.147.226/32,默认线路,no-resolve
  - IP-CIDR,120.253.253.226/32,默认线路,no-resolve
  - IP-CIDR,120.253.255.162/32,默认线路,no-resolve
  - IP-CIDR,120.253.255.34/32,默认线路,no-resolve
  - IP-CIDR,120.253.255.98/32,默认线路,no-resolve
  - IP-CIDR,180.163.150.162/32,默认线路,no-resolve
  - IP-CIDR,180.163.150.34/32,默认线路,no-resolve
  - IP-CIDR,180.163.151.162/32,默认线路,no-resolve
  - IP-CIDR,180.163.151.34/32,默认线路,no-resolve
  - IP-CIDR,203.208.39.0/24,默认线路,no-resolve
  - IP-CIDR,203.208.40.0/24,默认线路,no-resolve
  - IP-CIDR,203.208.41.0/24,默认线路,no-resolve
  - IP-CIDR,203.208.43.0/24,默认线路,no-resolve
  - IP-CIDR,203.208.50.0/24,默认线路,no-resolve
  - IP-CIDR,220.181.174.162/32,默认线路,no-resolve
  - IP-CIDR,220.181.174.226/32,默认线路,no-resolve
  - IP-CIDR,220.181.174.34/32,默认线路,no-resolve

  # ============================================================================
  # 白名单模式
  # ----------------------------------------------------------------------------
  - GEOIP,CN,DIRECT
  - MATCH,默认线路
